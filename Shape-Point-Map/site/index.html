<html>
<head>
    <title>Shape Point Map</title>

    <!-- Include css files and a favicon icon -->
    <link rel="stylesheet" href="css/leaflet.css" />
    <link rel="stylesheet" href="css/style.css"/>
    <link rel="stylesheet" href="css/leaflet.zoomhome.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/L.Control.MousePosition.css"/>
    
    <!-- Include javascript files -->
    <script src="javascript/leaflet.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="javascript/leaflet.zoomhome.min.js"></script>
    <script src="javascript/L.Control.MousePosition.js"></script>
    <script src="javascript/leaflet-color-markers.js"></script>
    <script src="javascript/leaflet-svg-shape-markers.min.js"></script>

</head>

<header>
    <h1>Leaflet Shape Point Map Example</h1>
</header>

<body>
    <div id="mapid">
        <script>
            /* Variable called map. This is what creates the actual leaflet map */
            var map = L.map('mapid', {zoomControl: false}).setView([38.99, -105.54], 7);

            /* Tile Layer that is added to our map. In this case it is a mapbox streets tile layer. */
            L.tileLayer('https://api.mapbox.com/styles/v1/korysam/cixur5uy7003g2sqwthpjmbxa/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1Ijoia29yeXNhbSIsImEiOiJjaXd4dDRxbTQwMXRkMm9tZzd5b3BqdTBwIn0.A2EGyNrWG2Lbbd5c-I-94w', {
                attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery &copy;<a href="http://mapbox.com">Mapbox</a>',
                    maxZoom: 18
                }).addTo(map);

            /* Top Left Corner of Map. Allows for a home button to reset to the default zoom. */
            var zoomHome = L.Control.zoomHome();
            zoomHome.addTo(map);
           
            /* Bottom Right corner. This shows the current lat and long  of the mouse cursor. 
            'ยบ' used for the degree character when the latitude and longitude of the 
            cursor is dispalyed. */
            L.control.mousePosition({position: 'bottomleft',lngFormatter: function(num) {
                var direction = (num < 0) ? 'W' : 'E';
                var formatted = Math.abs(L.Util.formatNum(num, 3)) + 'ยบ ' + direction;
                return formatted; 
            },
            latFormatter: function(num) {
                var direction = (num < 0) ? 'S' : 'N';
                var formatted = Math.abs(L.Util.formatNum(num, 3)) + 'ยบ ' + direction;
                return formatted;
            }}).addTo(map);


            /* Bottom Left corner. This shows the scale in km and miles of
            the map. */
            L.control.scale({position: 'bottomleft',imperial: true}).addTo(map);

            /* Bottom Right Corner. This shows the legend for the map */
            var legend = L.control({position: 'bottomright'});

            legend.onAdd = function (map) {

                var div = L.DomUtil.create('div', 'info legend');
                div.innerHTML += '<h4>Key</h4>';
                div.innerHTML += '<i style="background:' + 'black' + '"></i> ' + "Active Ditches<br><br>";
                div.innerHTML += '<i style="background:' + 'red' + '"></i> ' + "Reservoirs<br><br>";
                return div;
            };

            legend.addTo(map);

            /* Get the data from active-ditches.geojson */
            $.getJSON("data-files/active-ditches.geojson",function(data){
                var ditchLayer = L.geoJSON(data, {
                pointToLayer: function(feature, latlng) {
                    var ditchMarker = L.shapeMarker(latlng, {
                        weight: 2,          // outline width in pixels
                        opacity: 1,         // opacity of outline
                        color: 'black',     // color of outline
                        fillOpacity: 0.3,   // opacity of shape interior
                        fillColor: 'black', // color of shape interior
                        shape: "diamond",   // style of shape (only avaliable with leaflet-svg-shape-markers.min.js)
                        radius: 5           // size of shape
                                            /* For more options see path options in https://leafletjs.com/reference-1.5.0.html#path-color */
                    }).addTo(map);
                    ditchMarker.bindPopup(feature.properties.structureName);
                }
                })
            });

            /* Get the data from reservoir-levels.geojson */
            $.getJSON("data-files/reservoir-levels.geojson",function(data){
                var reservoirLayer = L.geoJSON(data, {
                pointToLayer: function(feature, latlng) {
                    var reservoirMarker = L.shapeMarker(latlng, {
                        weight: 2,
                        opacity: 1,
                        color: 'red',
                        fillOpacity: 0.3,
                        fillColor: 'red',
                        shape: "circle",
                        radius: 5
                    }).addTo(map);
                    reservoirMarker.bindPopup(feature.properties.Name);
                }
                })
            });
        </script>
    </div>
</body>
</html>